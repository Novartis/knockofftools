<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="knockofftools">
<title>The knockofftools package • knockofftools</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The knockofftools package">
<meta property="og:description" content="knockofftools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">knockofftools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/knockofftools.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/predictive-with-knockoffs.html">Deriving predictive variables using knockoffs</a>
    <a class="dropdown-item" href="../articles/simdata.html">The simdata dataset</a>
    <a class="dropdown-item" href="../articles/survival-analysis-with-knockoffs.html">Survival analysis with knockoffs</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>The knockofftools package</h1>
                        <h4 data-toc-skip class="author">Matthias
Kormaksson, Kostas Sechidis</h4>
            
            <h4 data-toc-skip class="date">January 11, 2024</h4>
      
      
      <div class="d-none name"><code>knockofftools.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In this vignette we demonstrate the main functionalities of the
knockofftools package. In particular, we demonstrate functions for
generating data sets, simulating knockoffs (MX and sequential), applying
the multiple knockoff filter for variable selection and visualizing
selections.</p>
<p>Let’s first recall how the knockoff variable selection methodology
works in a nutshell:</p>
<ol style="list-style-type: decimal">
<li>Simulate a knockoff copy <span class="math inline">\(\tilde{X}\)</span> of the original covariates data
<span class="math inline">\(X\)</span>.</li>
<li>Compute feature statistics <span class="math inline">\(W_j=|\beta_j|-|\tilde{\beta}_j|\)</span> from an
aggregated regression of <span class="math inline">\(Y\)</span> on <span class="math inline">\(X\)</span> and <span class="math inline">\(\tilde{X}\)</span>. Large, positive statistics
<span class="math inline">\(W_j\)</span> indicate association of <span class="math inline">\(X_j\)</span> with <span class="math inline">\(Y\)</span>.</li>
<li>For FDR control use the <em>knockoffs<span class="math inline">\(+\)</span></em> procedure to select variables
<span class="math inline">\(j\)</span> that fulfill <span class="math inline">\(W_j \geq \tau_+\)</span> where <span class="math display">\[
\tau_+ = \underset{t&gt;0}{\operatorname{argmin}} \left\{\frac{1 + |\{j
: W_j \leq t\}|}{|\{j : W_j \leq t\}|} \leq q\right\}.
\]</span> This workflow selects variables associated with response with
guaranteed control of false discovery rate <span class="math inline">\(FDR \leq q\)</span>.</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://opensource.nibr.com/knockofftools/">knockofftools</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simdata">Data generation<a class="anchor" aria-label="anchor" href="#simdata"></a>
</h2>
<p>In this section we will simulate a toy data set with a known truth.
In particular, we will simulate a set of covariates <span class="math inline">\(X\)</span> and a response <span class="math inline">\(y\)</span> that is associated with some of the
<span class="math inline">\(X\)</span>’s through a regression model.</p>
<p><em>Simulation of <span class="math inline">\(X\)</span>:</em> The
<code>generate_X</code> function simulates the rows of an <span class="math inline">\(n \times p\)</span> data frame <span class="math inline">\(X\)</span> independently from a multivariate
Gaussian distribution with mean <span class="math inline">\(0\)</span>
and <span class="math inline">\(p \times p\)</span> covariance matrix
<span class="math display">\[
\Sigma_{ij} = \left \{
\begin{array}{lr}
1\{i = j\}, &amp; \text{Independent,} \\
\rho^{1\{i \neq j\}}, &amp; \text{Equicorrelated,} \\
\rho^{|i-j|}, &amp; \text{AR1},
\end{array}
\right.
\]</span> where <span class="math inline">\(p_b\)</span> randomly
selected columns are then dichotomized with the indicator function <span class="math inline">\(\delta(x)=1(x &gt; 0)\)</span>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate a 2000 x 30 Gaussian data.frame under equi-correlation(rho=0.5) structure, </span></span>
<span><span class="co"># with 10 of the columns dichotomized</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_X.html">generate_X</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">2000</span>, p<span class="op">=</span><span class="fl">30</span>, p_b<span class="op">=</span><span class="fl">10</span>, cov_type <span class="op">=</span> <span class="st">"cov_equi"</span>, rho<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p>The covariance type is specified with the parameter
<code>cov_type</code> and the correlation coefficient with
<code>rho</code>. Each column of the resulting data.frame is either of
class <code>"numeric"</code> (for the continuous columns) or
<code>"factor"</code> (for the binary columns).</p>
<p><em>Simulation of <span class="math inline">\(y|X\)</span>:</em> The
<code>generate_y</code> function simulates a response <span class="math inline">\(y\)</span> from the (sparse) regression model
<span class="math display">\[
y = X \beta + \varepsilon, \textrm{ where } \varepsilon \sim N(0,I_n),
\]</span> where the first <code>p_nn</code> regression coefficients are
non-zero, all other are set to zero. The (common) amplitude of the
non-zero regression coefficients is specified with <code>a</code>. Here
we generate <span class="math inline">\(y\)</span> that is associated
with the first 10 covariates, each with amplitude <span class="math inline">\(a=0.1\)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate y ~ N(X%*%beta,I_n) where first 10 beta-coefficients are = a, all other = 0.</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_y.html">generate_y</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">X</span>, p_nn<span class="op">=</span><span class="fl">10</span>, a<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<p>Note that inside <code>generate_y</code> the model.matrix of
<code>X</code> is first scaled.</p>
</div>
<div class="section level2">
<h2 id="knockoff-generation">Knockoff generation<a class="anchor" aria-label="anchor" href="#knockoff-generation"></a>
</h2>
<p><em>Sequential knockoffs:</em> The function <code>knockoff</code>
receives as input a data.frame (or tibble) <code>X</code> whose columns
are either of class <code>"numeric"</code> (for the continuous columns)
or <code>"factor"</code> (for the categorical columns). This is a common
format of data involving both continuous and categorical predictors. The
output is a data.frame (or tibble) corresponding to the knockoff copy of
<code>X</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate sequential knockoff of X:</span></span>
<span><span class="va">Xk</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/knockoff.html">knockoff</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span></code></pre></div>
<p>The above function will by default sample sequential knockoffs
(method=“seq”) based on LASSO regression (see <span class="citation">(<a href="#ref-seqknockoffpaper" role="doc-biblioref">Kormaksson et al.
2021</a>)</span>). Behind the scenes, <code>knockoff</code> calls the
function <code><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html" class="external-link">glmnet::cv.glmnet</a></code> sequentially.</p>
<p><em>MX-knockoffs:</em> We can also simulate Gaussian MX-knockoffs
(via call to <code><a href="https://rdrr.io/pkg/knockoff/man/create.second_order.html" class="external-link">knockoff::create.second_order</a></code>). This function
only works on data frames with all “numeric” columns.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate a 2000 x 30 Gaussian data.frame under equi-correlation(rho=0.5) structure, </span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_X.html">generate_X</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">2000</span>, p<span class="op">=</span><span class="fl">30</span>, p_b<span class="op">=</span><span class="fl">0</span>, cov_type <span class="op">=</span> <span class="st">"cov_equi"</span>, rho<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co"># Simulate second order multivariate Gaussian MX knockoff:</span></span>
<span><span class="va">Xk</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/knockoff.html">knockoff</a></span><span class="op">(</span><span class="va">X</span>, method<span class="op">=</span><span class="st">"mx"</span><span class="op">)</span></span></code></pre></div>
<p>Note that in practice the user does not really need to call the
<code>knockoff</code> function directly, as the two main functions
<code>knockoff.statistics</code> and <code>variable.selections</code>
implement the full knockoff filter workflow. These will now be discussed
below.</p>
</div>
<div class="section level2">
<h2 id="knockoff-feature-statistics">Knockoff (feature) statistics<a class="anchor" aria-label="anchor" href="#knockoff-feature-statistics"></a>
</h2>
<p>The function <code>knockoff.statistics</code> takes as main input
<code>y</code>, <code>X</code>, and <code>type</code> (defaults to
<code>type="regression"</code>) and then proceeds to 1) simulate
independently <code>M</code> knockoffs <span class="math inline">\(\tilde{X}_k\)</span>, <span class="math inline">\(k=1,\dots,M\)</span>, 2) fit an aggregated
regression model: <span class="math display">\[\begin{align}
Y = X \beta^{(k)} + \tilde{X}_k \tilde{\beta}^{(k)} + \varepsilon,
\end{align}\]</span> for each of the <span class="math inline">\(k=1,\dots,M\)</span> knockoff copies. Then finally
calculate (for each knockoff <span class="math inline">\(k\)</span>) the
corresponding knockoff (feature) statistics <span class="math inline">\(W^{(k)}_j =
|\beta_j^{(k)}|-|\tilde{\beta}_j^{(k)}|\)</span>. By changing the
<code>M</code> parameter of <code>knockoff.statistics</code> we can
calculate multiple knockoff statistics in parallel:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_X.html">generate_X</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">2000</span>, p<span class="op">=</span><span class="fl">30</span>, p_b<span class="op">=</span><span class="fl">0</span>, cov_type <span class="op">=</span> <span class="st">"cov_ar1"</span>, rho<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_y.html">generate_y</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">X</span>, p_nn<span class="op">=</span><span class="fl">10</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">W</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/knockoff.statistics.html">knockoff.statistics</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">X</span>, M<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p>The output <code>W</code> is a data.frame of knockoff statistics
across the <code>M</code> knockoff replicates.</p>
<p>Since the <code>knockoff.statistics</code> may take long to run for a
single knockoff copy, in particular with sequential knockoffs
(knockoffs.method=“seq”), we use parallel computing via the package
<code>clustermq</code> by default. Note that the user can specify a
cluster.scheduler that is system dependent. On our HPC we utilize the
LSF job scheduler, but other options (including local parallelization)
are outlined here: <a href="https://cran.r-project.org/web/packages/clustermq/vignettes/userguide.html" class="external-link">User
Guide - clustermq</a></p>
</div>
<div class="section level2">
<h2 id="variable-selection-based-on-multiple-knockoff-statistics">Variable selection based on multiple knockoff statistics<a class="anchor" aria-label="anchor" href="#variable-selection-based-on-multiple-knockoff-statistics"></a>
</h2>
<p>To calculate which variables will be selected for each of these
knockoff statistics we use the <code>variable.selections</code>
function. This function takes the knockoff statistics <code>W</code> as
input and additionally specifies the <code>error.type="fdr"</code>
(default), <code>"pfer"</code> (per family error error), or
<code>"kfwer"</code> (k-familywise error rate) and the corresponding
nominal error level.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S</span> <span class="op">=</span> <span class="fu"><a href="../reference/variable.selections.html">variable.selections</a></span><span class="op">(</span><span class="va">W</span>, level <span class="op">=</span> <span class="fl">0.1</span>, error.type<span class="op">=</span><span class="st">"fdr"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">S</span><span class="op">$</span><span class="va">selected</span><span class="op">)</span></span>
<span><span class="co">#&gt;    S1 S2 S3 S4 S5 S6 S7 S8 S9 S10</span></span>
<span><span class="co">#&gt; X1  1  1  1  1  1  1  1  1  1   1</span></span>
<span><span class="co">#&gt; X2  1  1  1  1  1  1  1  1  1   1</span></span>
<span><span class="co">#&gt; X3  1  1  1  1  1  1  1  1  1   1</span></span>
<span><span class="co">#&gt; X4  1  1  1  1  1  1  1  1  1   1</span></span>
<span><span class="co">#&gt; X5  1  1  1  1  1  1  1  1  1   1</span></span>
<span><span class="co">#&gt; X6  1  1  1  1  1  1  1  1  1   1</span></span>
<span><span class="va">S</span><span class="op">$</span><span class="va">stable.variables</span></span>
<span><span class="co">#&gt;  [1] "X1"  "X2"  "X3"  "X4"  "X5"  "X6"  "X7"  "X8"  "X9"  "X10" "X12" "X20"</span></span></code></pre></div>
<p>In a nutshell the function will both calculate individual variable
selections (for each knockoff replicate), but also a stable set of
variables that are selected most frequently among the replicates. For
FDR-control the stable variables are calculated using the heuristics in
<a href="#multiple-knockoffs-filter-procedure">The multiple knockoffs
filter procedure</a>, while for the other two error types
(<code>"pfer"</code> and <code>"kfwer"</code>) we simply choose all
variables selected more than <code>thres*M</code> times, where
<code>thres</code> is an optional parameter of the
<code>variable.selections</code> function (<code>thres=0.5</code> by
default).</p>
</div>
<div class="section level2">
<h2 id="heatmap-of-multiple-variable-selections">Heatmap of multiple variable selections<a class="anchor" aria-label="anchor" href="#heatmap-of-multiple-variable-selections"></a>
</h2>
<p>In order to evaluate the robustness of the knockoff selection
procedure we can visualize a heatmap of the selections across the
knockoff replicates.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span></span></code></pre></div>
<p><img src="knockofftools_files/figure-html/unnamed-chunk-8-1.png" width="686.4">
We apply co-clustering of the rows and columns of the heatmap and then
order the blocks according to increasing mean number of selections. This
helps with aesthetics, but also helps visualize the most important
variables that should tend towards the top of the heatmap.</p>
</div>
<div class="section level2">
<h2 id="appendix">Appendix<a class="anchor" aria-label="anchor" href="#appendix"></a>
</h2>
<div class="section level3">
<h3 id="multiple-knockoffs-filter-procedure">A. The multiple knockoffs filter procedure for FDR-control<a class="anchor" aria-label="anchor" href="#multiple-knockoffs-filter-procedure"></a>
</h3>
<p><span class="citation">(<a href="#ref-seqknockoffpaper" role="doc-biblioref">Kormaksson et al. 2021</a>)</span> introduced a
heuristic algorithm for selecting stable variables from multiple
independent knockoff variable selections.</p>
<p>Let <span class="math inline">\(\tilde{X}_1, \dots,
\tilde{X}_B\)</span> denote <span class="math inline">\(B\)</span>
independent knockoff copies of <span class="math inline">\(X\)</span>.
For each knockoff copy <span class="math inline">\(b\)</span> run the
knockoff filter and select the set of influential variables, <span class="math inline">\(S_b \subseteq \{1,\dots,p\}\)</span>. We propose
the following heuristics to select a final set of variables:</p>
<ul>
<li>Let <span class="math inline">\(F(r) \subseteq
\{1,\dots,p\}\)</span>, where <span class="math inline">\(r \in [0.5,
1]\)</span>, denote the set of variables selected more than <span class="math inline">\(r \cdot B\)</span> times out of the <span class="math inline">\(B\)</span> knockoff draws.</li>
<li>Let <span class="math inline">\(S(r)=\underset{b}{\rm mode}\{F(r)
\cap S_b\}\)</span> denote the set of selected variables that appears
most frequently, after filtering out variables that are not in <span class="math inline">\(F(r)\)</span>.</li>
<li>Return <span class="math inline">\(\hat{S} = S(\hat{r})\)</span>,
where <span class="math inline">\(\hat{r} = \underset{r \geq
0.5}{\operatorname{argmax}} |{S(r)}|\)</span>, i.e. the largest set
among <span class="math inline">\(\{S(r):r \geq 0.5\}\)</span>.</li>
</ul>
<p>The first step above essentially filters out variables that don’t
appear more than <span class="math inline">\((100\cdot r)\%\)</span> of
the time, which would seem like a reasonable requirement in practice
(e.g. with <span class="math inline">\(r=0.5\)</span>). The second step
above then filters the <span class="math inline">\(B\)</span> knockoff
selections <span class="math inline">\(S_b\)</span> accordingly and
searches for the most frequent variable set among those. The third step
then establishes the final selection, namely the most liberal variable
selection among the sets <span class="math inline">\(\{S(r):r \geq
0.5\}\)</span>.</p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-seqknockoffpaper" class="csl-entry">
Kormaksson, M., L. J. Kelly, X. Zhu, S. Haemmerle, L. Pricop, and D.
Ohlssen. 2021. <span>“Sequential Knockoffs for Continuous and
Categorical Predictors: With Application to a Large Psoriatic Arthritis
Clinical Trial Pool.”</span> <em>Statistics in Medicine</em>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Matthias Kormaksson, Kostas Sechidis, Manuela Zimmermann.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
